







<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name='viewport' content="width=device-width, initial-scale=1" />
        <meta property="og:title" content="Bevy - Queries" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://bevyengine.org&#x2F;learn&#x2F;book&#x2F;getting-started&#x2F;queries&#x2F;" />
        <meta property="og:image" content="https://bevyengine.org/assets/bevy_logo_fill.png" />
        <meta property="og:description" content="Bevy is a refreshingly simple data-driven game engine built in Rust. It is free and open-source forever!" />
        <link rel="shortcut icon" type="image/png" href="/assets/favicon.png">
        <link rel="stylesheet" href="/site.css" />
        <link href="atom.xml" rel="alternate" type="application/atom+xml" />
        <title>Bevy - Queries</title>
        
<script src="/optional-helpers.js"></script>

    </head>

    <body>
        <div class="headerbar-container">
            <nav class="headerbar container">
                <a href="/" class="header-logo">
                    <img src="/assets/bevy_logo_dark.svg" class="logo" alt="bevy logo" />
                </a>
                <a href="/" class="header-logo-mobile">
                    <img src="/assets/bevy_icon_dark.svg" class="logo" alt="bevy icon" />
                </a>
                <div class="header-item header-message">
                    
                        The Book
                    
                </div>
                <div class="header-item header-push"></div>
                



    


<a href="&#x2F;" class="header-item" >
    Features
</a>

                



    


<a href="&#x2F;learn" class="header-item header-item-active"  >
    Learn
</a>

                



    


<a href="&#x2F;news" class="header-item" >
    News
</a>

                



    


<a href="&#x2F;community" class="header-item" >
    Community
</a>

                <a class="header-item header-button header-button-donate" href="https://github.com/sponsors/cart">Donate <img src="/assets/heart.svg" class="header-button-donate-heart"/></a>
                <a class="header-item header-button" href="/learn/book/getting-started/">Get Started</a>
            </nav>
        </div>
        <section class="section">
            <div class="container">
                
<div class="book-page">
    <nav class="book-nav" role="navigation">
        
        
        <ul class="book-nav-sections-container book-nav-sections">
            
            

<li class="book-nav-section">
    <a href="https:&#x2F;&#x2F;bevyengine.org&#x2F;learn&#x2F;book&#x2F;introduction&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">1.</strong>
        introduction
    </a>
    
</li>

            
            

<li class="book-nav-section">
    <a href="https:&#x2F;&#x2F;bevyengine.org&#x2F;learn&#x2F;book&#x2F;getting-started&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">2.</strong>
        getting started
    </a>
    
    <ul class="book-nav-sections book-nav-sections-indented">
        
        
        

<li class="book-nav-section">
    <a href="https:&#x2F;&#x2F;bevyengine.org&#x2F;learn&#x2F;book&#x2F;getting-started&#x2F;setup&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">2.1.</strong>
        setup
    </a>
    
</li>

        
        
        

<li class="book-nav-section">
    <a href="https:&#x2F;&#x2F;bevyengine.org&#x2F;learn&#x2F;book&#x2F;getting-started&#x2F;apps&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">2.2.</strong>
        apps
    </a>
    
</li>

        
        
        

<li class="book-nav-section">
    <a href="https:&#x2F;&#x2F;bevyengine.org&#x2F;learn&#x2F;book&#x2F;getting-started&#x2F;ecs&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">2.3.</strong>
        ecs
    </a>
    
</li>

        
        
        

<li class="book-nav-section">
    <a href="https:&#x2F;&#x2F;bevyengine.org&#x2F;learn&#x2F;book&#x2F;getting-started&#x2F;plugins&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">2.4.</strong>
        plugins
    </a>
    
</li>

        
        
        

<li class="book-nav-section">
    <a href="https:&#x2F;&#x2F;bevyengine.org&#x2F;learn&#x2F;book&#x2F;getting-started&#x2F;resources&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">2.5.</strong>
        resources
    </a>
    
</li>

        
        
        

<li class="book-nav-section">
    <a href="https:&#x2F;&#x2F;bevyengine.org&#x2F;learn&#x2F;book&#x2F;getting-started&#x2F;queries&#x2F;" class="book-nav-section-title-active book-nav-section-title" >
        <strong class="book-nav-section-number">2.6.</strong>
        queries
    </a>
    
</li>

        
    </ul>
    
</li>

            
            

<li class="book-nav-section">
    <a href="https:&#x2F;&#x2F;bevyengine.org&#x2F;learn&#x2F;book&#x2F;next-steps&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">3.</strong>
        next steps
    </a>
    
</li>

            
            

<li class="book-nav-section">
    <a href="https:&#x2F;&#x2F;bevyengine.org&#x2F;learn&#x2F;book&#x2F;contributing&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">4.</strong>
        contributing
    </a>
    
    <ul class="book-nav-sections book-nav-sections-indented">
        
        
        

<li class="book-nav-section">
    <a href="https:&#x2F;&#x2F;bevyengine.org&#x2F;learn&#x2F;book&#x2F;contributing&#x2F;code&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">4.1.</strong>
        code
    </a>
    
</li>

        
        
        

<li class="book-nav-section">
    <a href="https:&#x2F;&#x2F;bevyengine.org&#x2F;learn&#x2F;book&#x2F;contributing&#x2F;docs&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">4.2.</strong>
        docs
    </a>
    
</li>

        
    </ul>
    
</li>

            
            

<li class="book-nav-section">
    <a href="https:&#x2F;&#x2F;bevyengine.org&#x2F;learn&#x2F;book&#x2F;faq&#x2F;" class="book-nav-section-title">
        <strong class="book-nav-section-number">5.</strong>
        faq
    </a>
    
</li>

            
        </ul>
        
    </nav>
    <div class="book-content">
        
        
        

            
            
            
                
            

        
            
            <a id="book-pager-bar-previous" href="https:&#x2F;&#x2F;bevyengine.org&#x2F;learn&#x2F;book&#x2F;getting-started&#x2F;resources&#x2F;" class="book-pager-bar book-pager-bar-previous">
                <div class="book-pager-bar-icon book-pager-bar-icon-previous">
                    <img src="/assets/pager_previous.svg" class="book-pager-image book-pager-image-left" />
                </div>
            </a>
        

        
        
            
            
            
                
            
         
        
            
            <a id="book-pager-bar-next" href="https:&#x2F;&#x2F;bevyengine.org&#x2F;learn&#x2F;book&#x2F;next-steps&#x2F;" class="book-pager-bar book-pager-bar-next">
                <div class="book-pager-bar-icon book-pager-bar-icon-next">
                <img src="/assets/pager_next.svg" class="book-pager-image book-pager-image-right" />
                </div>
            </a>
        
        <h1>
            
                Queries
            
            
        </h1>
        <div class="media-content"><p>In Bevy ECS, <code>Queries</code> give you direct control over entity iteration. They also provide a few extra filtering options, such as <code>With&lt;Component&gt;</code> and <code>Without&lt;Component&gt;</code> filters.</p>
<h2 id="fixing-our-bug">Fixing our Bug</h2>
<p>Up until now, we have been using <strong>For-Each Systems</strong>, which directly reference components and run once for each entity. In the case of our <code>greet_people</code> system, the <strong>For-Each System</strong> behavior doesn't quite line up with the logic we want because it runs once for each entity:</p>
<pre style="background-color:#2b2c2f;">
<code><span style="color:#c594c5;">fn </span><span style="color:#6699cc;">greet_people</span><span style="color:#5fb3b3;">(
    </span><span style="color:#f99157;">time</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">Res</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;">Time</span><span style="color:#5fb3b3;">&gt;</span><span style="color:#cccece;">, </span><span style="color:#c594c5;">mut </span><span style="color:#f99157;">timer</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">ResMut</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;">GreetTimer</span><span style="color:#5fb3b3;">&gt;</span><span style="color:#cccece;">, </span><span style="color:#f99157;">person</span><span style="color:#5fb3b3;">: &amp;</span><span style="color:#cccece;">Person, </span><span style="color:#f99157;">name</span><span style="color:#5fb3b3;">: &amp;</span><span style="color:#cccece;">Name</span><span style="color:#5fb3b3;">) {</span><span style="color:#cccece;">
    timer</span><span style="color:#5fb3b3;">.</span><span style="color:#f99157;">0.</span><span style="color:#6699cc;">tick</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">time</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">delta_seconds</span><span style="color:#5fb3b3;">);
    </span><span style="color:#c594c5;">if</span><span style="color:#cccece;"> timer</span><span style="color:#5fb3b3;">.</span><span style="color:#f99157;">0.</span><span style="color:#cccece;">finished </span><span style="color:#5fb3b3;">{
        </span><span style="color:#cccece;">println!</span><span style="color:#5fb3b3;">(&quot;</span><span style="color:#99c794;">hello {}!</span><span style="color:#5fb3b3;">&quot;,</span><span style="color:#cccece;"> name</span><span style="color:#5fb3b3;">.</span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">);
    }
}
</span></code></pre>
<p>The solution is to use a <strong>Query System</strong> instead:</p>
<pre style="background-color:#2b2c2f;">
<code><span style="color:#c594c5;">fn </span><span style="color:#6699cc;">greet_people</span><span style="color:#5fb3b3;">(
    </span><span style="color:#f99157;">time</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">Res</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;">Time</span><span style="color:#5fb3b3;">&gt;</span><span style="color:#cccece;">, </span><span style="color:#c594c5;">mut </span><span style="color:#f99157;">timer</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">ResMut</span><span style="color:#5fb3b3;">&lt;</span><span style="color:#cccece;">GreetTimer</span><span style="color:#5fb3b3;">&gt;</span><span style="color:#cccece;">, </span><span style="color:#c594c5;">mut </span><span style="color:#f99157;">query</span><span style="color:#5fb3b3;">: </span><span style="color:#cccece;">Query</span><span style="color:#5fb3b3;">&lt;(&amp;</span><span style="color:#cccece;">Person, </span><span style="color:#5fb3b3;">&amp;</span><span style="color:#cccece;">Name</span><span style="color:#5fb3b3;">)&gt;) {</span><span style="color:#cccece;">
    timer</span><span style="color:#5fb3b3;">.</span><span style="color:#f99157;">0.</span><span style="color:#6699cc;">tick</span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">time</span><span style="color:#5fb3b3;">.</span><span style="color:#cccece;">delta_seconds</span><span style="color:#5fb3b3;">);
    </span><span style="color:#c594c5;">if</span><span style="color:#cccece;"> timer</span><span style="color:#5fb3b3;">.</span><span style="color:#f99157;">0.</span><span style="color:#cccece;">finished </span><span style="color:#5fb3b3;">{
        </span><span style="color:#c594c5;">for </span><span style="color:#5fb3b3;">(</span><span style="color:#cccece;">_person</span><span style="color:#5fb3b3;">,</span><span style="color:#cccece;"> name</span><span style="color:#5fb3b3;">) in &amp;</span><span style="color:#c594c5;">mut</span><span style="color:#cccece;"> query</span><span style="color:#5fb3b3;">.</span><span style="color:#6699cc;">iter</span><span style="color:#5fb3b3;">() {
            </span><span style="color:#cccece;">println!</span><span style="color:#5fb3b3;">(&quot;</span><span style="color:#99c794;">hello {}!</span><span style="color:#5fb3b3;">&quot;,</span><span style="color:#cccece;"> name</span><span style="color:#5fb3b3;">.</span><span style="color:#f99157;">0</span><span style="color:#5fb3b3;">);
        }
    }
}
</span></code></pre>
<p>Now our App should properly greet all <code>People</code>, once every two seconds!</p>
<h2 id="query-systems-vs-for-each-systems">Query Systems vs For-Each Systems</h2>
<p>Now that we have two different system types, how do you choose which one to use?</p>
<p>This is largely an aesthetic question. Some developers will prefer the simplicity and legibility of <strong>For-Each Systems</strong> and will use them wherever they can. Others will prefer the flexibility of <strong>Query Systems</strong>. There are no right answers here. You should use what works best for you!</p>
</div>
        <div class="book-pagers" />
    </div>
</div>


            </div>
        </section>
    </body>
</html>